.module-wrap
  .module-gradient-container
    .module
      #project
        = link_to "<< Back to client: #{@client}", client_path(@client)
        %h1= @client.to_s
        %h2
          = @project.to_s
          = link_to "Edit", edit_client_project_path(@client, @project)
      %table.tickets
        %thead
          %tr
            %th Tickets
            %th Work Units
            %th Hours
            %th{:colspan => 2}
        %tbody
          - @project.tickets.each do |ticket|
            %tr
              %td= link_to ticket, project_ticket_path(@project, ticket)
              %td= link_to ticket.work_units.count, ticket_work_units_path(ticket)
              %td= ticket.work_units.inject(0) {|hours, work_unit| hours + work_unit.hours }
              %td= link_to 'Edit', edit_project_ticket_path(@project, ticket)
              %td= button_to 'Destroy', { :action => 'destroy', :id => ticket.id }, :confirm => 'Are you sure?', :method => :delete
        %h2= 'Status: ' << @client.status

      = render :partial => "comments/comments", :locals => {:comments => @project.comments}
      = render :partial => "comments/comment_form", :locals => { :commentable_id => @project.id, :commentable_field => "project_id", :commentable_type => "Project", :refurl => client_project_path(@project), :comment_num => @project.id }
      %h2 Files
      %ul
        - @project.file_attachments.each do |file_attachment|
          %li= link_to file_attachment.attachment_file_file_name, file_attachment_path(file_attachment.id)
      = link_to "Add File Attachment", new_file_attachment_path( :project_id => @project.id )
